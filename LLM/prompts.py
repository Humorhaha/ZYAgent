"""
LLM Prompts - 所有 LLM Prompt 模板的集中管理

设计原则:
    - 统一管理: 所有 Prompt 在此文件定义
    - 易于修改: 修改此文件即可调整所有 Prompt
    - 版本控制: 便于跟踪 Prompt 变更历史
"""


# =============================================================================
# TTS Buffer 压缩
# =============================================================================

TTS_COMPRESS = """你是一个精准的信息压缩专家。你的任务是将执行轨迹压缩为关键信息摘要。

## 当前轨迹
{current_trajectory}

## 历史压缩摘要 (如果有)
{previous_summary}

## 要求
1. 提取关键的决策点和结果
2. 保留错误信息和失败原因 (这些对后续决策很重要)
3. 删除冗余的中间步骤
4. 输出格式: 简洁的摘要 (2-3 句话)

## 输出
请直接输出压缩后的摘要，不要包含任何解释:"""


# =============================================================================
# 轨迹分析
# =============================================================================

TRAJECTORY_ANALYSIS = """分析以下执行轨迹，提取关键信息:

## 轨迹
{trajectory}

## 任务目标
{goal}

## 请提取以下信息 (JSON 格式):
1. key_decisions: 关键决策列表
2. outcomes: 结果列表 (成功/失败)
3. insights: 可借鉴的洞察
4. errors: 错误信息 (如果有)

## 输出 (JSON):"""


# =============================================================================
# 知识提炼 (L1 -> L2)
# =============================================================================

KNOWLEDGE_DISTILL = """将以下原始经验提炼为可复用的知识:

## 原始经验
{raw_experience}

## 任务类型
{task_type}

## 要求
1. 提取通用的问题解决模式
2. 用一句话概括核心洞察
3. 避免过于具体的细节

## 输出 (一句话):"""


# =============================================================================
# Wisdom 生成 (L2 -> L3)
# =============================================================================

WISDOM_GENERATION = """基于以下知识和经验，生成可跨任务复用的智慧:

## 任务描述
{task_descriptor}

## 成功经验
{success_experience}

## 要求
1. 提炼出通用的策略或模式
2. 用简洁的语言表达 (1-2 句话)
3. 确保可以应用于类似任务

## 输出:"""


# =============================================================================
# Reflect Agent
# =============================================================================

REFLECT_ANALYSIS = """分析以下执行结果，找出失败原因并提供改进建议:

## 任务
{task}

## 执行过程
{trajectory}

## 失败原因
{failure_reason}

## 请提供:
1. 根本原因分析
2. 具体改进建议
3. 下一步应该尝试的方向

## 输出:"""


# =============================================================================
# Distillation Agent
# =============================================================================

DISTILLATION_PROMPT = """基于以下信息，为 Agent 生成初始上下文:

## 任务描述
{task}

## 相关 Wisdom (历史经验)
{wisdom}

## 相关示例 (如果有)
{examples}

## 请生成一个简洁的执行指南，帮助 Agent 快速开始任务:"""


# =============================================================================
# SPIRAL Critic (MCTS 节点评估)
# =============================================================================

CRITIC_EVALUATE = """你是 SPIRAL MCTS 中的 Critic Agent。你的任务是评估一个动作的策略价值。

## 当前状态
{current_state}

## 执行的动作
{action}

## 动作后的新状态
{next_state}

## 评估要求
1. 分析这个动作是否有助于完成目标
2. 评估动作的合理性和效率
3. 考虑可能的风险和副作用

## 输出格式 (严格 JSON)
请直接输出 JSON，不要包含任何其他内容:
```json
{{
    "score": <0.0-1.0 的浮点数，1.0 表示最佳>,
    "reasoning": "<你的思考过程，说明为什么给出这个分数>"
}}
```"""


# =============================================================================
# 导出所有 Prompts
# =============================================================================

__all__ = [
    "TTS_COMPRESS",
    "TRAJECTORY_ANALYSIS",
    "KNOWLEDGE_DISTILL",
    "WISDOM_GENERATION",
    "REFLECT_ANALYSIS",
    "DISTILLATION_PROMPT",
    "CRITIC_EVALUATE",
]
